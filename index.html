<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kan du v칛rldens flaggor?</title>
    <!-- Laddar Tailwind CSS via CDN f칬r enkel styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* S칛tter 'Inter' som standardfont */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f4f8; /* L칛tt ljusbl친 bakgrund */
        }
        /* Extra stor flagga */
        #flag-display {
            font-size: 8rem;
            line-height: 1;
            transition: transform 0.3s ease-out;
            cursor: default;
        }
        /* Knappeffekt f칬r feedback */
        .option-button:active {
            transform: scale(0.98);
        }
        /* Animation f칬r meddelanden */
        @keyframes fade-in-out {
            0% { opacity: 0; transform: translateY(-10px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(10px); }
        }
        #message-display {
            animation: fade-in-out 3s ease-in-out forwards;
        }
        /* Mobilanpassning: Minskar storlek p친 flaggan p친 sm친 sk칛rmar */
        @media (max-width: 640px) {
            #flag-display {
                font-size: 6rem;
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div id="app-container" class="bg-white p-6 sm:p-10 rounded-xl shadow-2xl max-w-lg w-full text-center">
        <!-- Rubrik -->
        <h1 class="text-3xl sm:text-4xl font-bold mb-6 text-gray-800">Kan du v칛rldens flaggor?</h1>

        <!-- Po칛ng och 칀terst칛llningsknapp -->
        <div class="flex justify-between items-center mb-6 border-b pb-4">
            <p class="text-xl font-semibold text-indigo-600">Po칛ng: <span id="score-display">0</span></p>
            <button id="reset-button" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-200">
                B칬rja om
            </button>
        </div>

        <!-- Meddelandedisplay (f칬r "R칛tt!" / "Fel!") -->
        <div class="h-8 mb-4">
            <p id="message-display" class="font-bold text-lg opacity-0"></p>
        </div>

        <!-- Flagga -->
        <div class="flex justify-center items-center h-32 mb-8">
            <span id="flag-display"></span>
        </div>

        <!-- Alternativknappar -->
        <div id="options-container" class="grid gap-4">
            <!-- Knapparna renderas av JavaScript h칛r -->
        </div>

    </div>

    <script>
        // Globala variabler f칬r DOM-element och spelstatus
        const scoreDisplay = document.getElementById('score-display');
        const flagDisplay = document.getElementById('flag-display');
        const optionsContainer = document.getElementById('options-container');
        const resetButton = document.getElementById('reset-button');
        const messageDisplay = document.getElementById('message-display');

        let score = 0;
        let correctAnswer = null;
        let allCountries = [];

        // 2. Data: Minst 30 l칛nder med flagg-emojis
        const countryData = [
            { name: 'Sverige', flag: '游젏릖' },
            { name: 'Norge', flag: '游游' },
            { name: 'Danmark', flag: '游뾇릖' },
            { name: 'Finland', flag: '游游' },
            { name: 'Island', flag: '游쉻릖' },
            { name: 'Tyskland', flag: '游뾇릖' },
            { name: 'Frankrike', flag: '游游' },
            { name: 'Spanien', flag: '游쀯릖' },
            { name: 'Italien', flag: '游쉻릖' },
            { name: 'Storbritannien', flag: '游섫릖' },
            { name: 'Kanada', flag: '游뻟릖' },
            { name: 'USA', flag: '游쥟릖' },
            { name: 'Mexiko', flag: '游쓇릖' },
            { name: 'Brasilien', flag: '游游' },
            { name: 'Argentina', flag: '游뷣릖' },
            { name: 'Japan', flag: '游游' },
            { name: 'Sydkorea', flag: '游썷릖' },
            { name: 'Kina', flag: '游뻟릖' },
            { name: 'Indien', flag: '游쉻릖' },
            { name: 'Australien', flag: '游뷣릖' },
            { name: 'Nya Zeeland', flag: '游游' },
            { name: 'Sydafrika', flag: '游游' },
            { name: 'Egypten', flag: '游쀯릖' },
            { name: 'Nigeria', flag: '游游' },
            { name: 'Kenya', flag: '游썷릖' },
            { name: 'Ryssland', flag: '游游' },
            { name: 'Nederl칛nderna', flag: '游游' },
            { name: 'Schweiz', flag: '游뻟릖' },
            { name: '칐sterrike', flag: '游뷣릖' },
            { name: 'Portugal', flag: '游왫릖' },
            { name: 'Irland', flag: '游쉻릖' },
            { name: 'Polen', flag: '游왫릖' },
            { name: 'Grekland', flag: '游섫릖' },
            { name: 'Thailand', flag: '游좷릖' } // Sista elementet. Inga kommatecken (trailing commas) ska finnas efter denna rad.
        ];

        /**
         * Slumpar fram ett element fr친n en array.
         * @param {Array<any>} array
         * @returns {any}
         */
        function getRandomElement(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        /**
         * Genererar en ny fr친ga, uppdaterar UI:n.
         */
        function generateNewQuestion() {
            if (countryData.length < 3) return; // Beh칬ver minst 3 l칛nder f칬r att skapa en fr친ga

            // 1. V칛lj det korrekta svaret slumpm칛ssigt
            correctAnswer = getRandomElement(countryData);
            
            // 2. V칛lj de tv친 felaktiga alternativen
            let incorrectOptions = countryData.filter(c => c.name !== correctAnswer.name);
            
            // Slumpa fram 2 unika felaktiga alternativ
            incorrectOptions = shuffleArray(incorrectOptions).slice(0, 2);

            // 3. Skapa listan med alla alternativ
            const options = [correctAnswer, ...incorrectOptions];
            
            // 4. Blanda alternativen s친 att det r칛tta svaret inte alltid 칛r p친 samma plats
            const shuffledOptions = shuffleArray(options);

            // 5. Uppdatera UI:n
            flagDisplay.textContent = correctAnswer.flag;
            optionsContainer.innerHTML = ''; // Rensa gamla knappar

            shuffledOptions.forEach(country => {
                const button = document.createElement('button');
                button.textContent = country.name;
                button.className = 'option-button bg-indigo-500 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-indigo-600 transition duration-150 ease-in-out focus:outline-none focus:ring-4 focus:ring-indigo-300';
                button.dataset.countryName = country.name;
                button.addEventListener('click', handleGuess);
                optionsContainer.appendChild(button);
            });
        }

        /**
         * Blanda en array (Fisher-Yates shuffle)
         * @param {Array<any>} array
         * @returns {Array<any>}
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * Hanterar anv칛ndarens gissning.
         * @param {Event} event
         */
        function handleGuess(event) {
            // F칬rhindra att man klickar p친 fler knappar under feedback-tiden
            optionsContainer.querySelectorAll('button').forEach(btn => btn.disabled = true);
            
            const selectedName = event.target.dataset.countryName;
            const isCorrect = selectedName === correctAnswer.name;

            if (isCorrect) {
                score++;
                showFeedback('R칛tt! +1 Po칛ng', 'text-green-600', 'bg-green-100');
            } else {
                showFeedback('Fel! Inga po칛ng.', 'text-red-600', 'bg-red-100');
            }

            scoreDisplay.textContent = score;
            
            // Markera den klickade knappen (och det korrekta svaret)
            optionsContainer.querySelectorAll('button').forEach(btn => {
                if (btn.dataset.countryName === selectedName) {
                    btn.classList.add(isCorrect ? 'ring-4', 'ring-green-500/50' : 'ring-4', 'ring-red-500/50');
                }
                if (!isCorrect && btn.dataset.countryName === correctAnswer.name) {
                    // Markera r칛tt svar om man gissade fel
                    btn.classList.add('bg-green-400', 'hover:bg-green-400');
                }
                btn.classList.remove('bg-indigo-500', 'hover:bg-indigo-600');
                btn.classList.add('bg-gray-300', 'cursor-default');
            });


            // V칛nta 1.5 sekunder och ladda sedan n칛sta fr친ga
            setTimeout(() => {
                // Ta bort feedback klasser och re-enable knappar (i generateNewQuestion)
                optionsContainer.querySelectorAll('button').forEach(btn => btn.disabled = false);
                generateNewQuestion();
            }, 1500);
        }

        /**
         * Visar ett tempor칛rt meddelande.
         * @param {string} message
         * @param {string} textColorClass - t.ex. 'text-green-600'
         * @param {string} bgClass - t.ex. 'bg-green-100'
         */
        function showFeedback(message, textColorClass, bgClass) {
            messageDisplay.textContent = message;
            // Ta bort gammal f칛rg och animation
            messageDisplay.className = 'font-bold text-lg opacity-0'; 
            // L칛gg till ny f칛rg, bakgrund och starta om animationen
            void messageDisplay.offsetWidth; // Trigger reflow for animation restart
            messageDisplay.classList.add(textColorClass, bgClass, 'p-2', 'rounded-lg', 'shadow-sm');
            messageDisplay.style.animation = 'none'; // Stoppa animation
            setTimeout(() => {
                messageDisplay.style.animation = ''; // 칀terst칛ll f칬r att starta om
            }, 10);
        }

        /**
         * 칀terst칛ller spelet till grundtillst친ndet.
         */
        function resetGame() {
            score = 0;
            scoreDisplay.textContent = score;
            messageDisplay.textContent = '';
            messageDisplay.className = 'font-bold text-lg opacity-0';
            generateNewQuestion();
        }


        // Eventlyssnare f칬r "B칬rja om"
        resetButton.addEventListener('click', resetGame);

        // Starta spelet n칛r sidan laddats
        window.onload = generateNewQuestion;
    </script>
